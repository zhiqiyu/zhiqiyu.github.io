<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Combine MODIS Terra and Aqua Product on GEE</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta name="generator" content="Hugo 0.50" />
	<meta property="og:title" content="Combine MODIS Terra and Aqua Product on GEE" />
<meta property="og:description" content="The Moderate Resolution Imaging Spectroradiometer (MODIS) has been providing high temporal resolution images since the first launch of Terra satellite in 1999 followed by the Aqua satellite in 2002. The Terra satellite passes from north to south in the morning at around 10:30 a.m. local time. The Aqua satellite passes from south to north in the afternoon at around 1:30 p.m. Since MODIS has a revisiting time of one or two days, for any given day, there are most likely be images from both Terra and Aqua satellites." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhiqiyu.github.io/post/combine-modis-terra-and-aqua-product-on-gee/" /><meta property="article:published_time" content="2020-02-04T15:21:38-05:00"/>
<meta property="article:modified_time" content="2020-02-04T15:21:38-05:00"/>

	<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Combine MODIS Terra and Aqua Product on GEE"/>
<meta name="twitter:description" content="The Moderate Resolution Imaging Spectroradiometer (MODIS) has been providing high temporal resolution images since the first launch of Terra satellite in 1999 followed by the Aqua satellite in 2002. The Terra satellite passes from north to south in the morning at around 10:30 a.m. local time. The Aqua satellite passes from south to north in the afternoon at around 1:30 p.m. Since MODIS has a revisiting time of one or two days, for any given day, there are most likely be images from both Terra and Aqua satellites."/>

	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="https://zhiqiyu.github.io/css/style.css">
	<link rel="shortcut icon" href="https://zhiqiyu.github.io/img/favicon-96.png">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-128672710-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<link rel="stylesheet" href="https://zhiqiyu.github.io/css/xcode.css" rel="stylesheet" id="theme-stylesheet">
	<script src="https://zhiqiyu.github.io/js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

	<div class="container">
		<div class="logo" role="banner">
			<a class="logo__link" href="https://zhiqiyu.github.io/" title="ZQ.Yu" rel="home">
				<div class="logo__title">ZQ.Yu</div>
				<div class="logo__tagline">Geospatial data explorer, Machine learning enthusiast</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="https://zhiqiyu.github.io/">Blog</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://zhiqiyu.github.io/about/">About</a>
		</li>
	</ul>
</nav>

	</div>

	<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https://zhiqiyu.github.io/"
    },
    "articleSection" : "post",
    "name" : "Combine MODIS Terra and Aqua Product on GEE",
    "headline" : "Combine MODIS Terra and Aqua Product on GEE",
    "description" : "The Moderate Resolution Imaging Spectroradiometer (MODIS) has been providing high temporal resolution images since the first launch of Terra satellite in 1999 followed by the Aqua satellite in 2002. The Terra satellite passes from north to south in the morning at around 10:30 a.m. local time. The Aqua satellite passes from south to north in the afternoon at around 1:30 p.m. Since MODIS has a revisiting time of one or two days, for any given day, there are most likely be images from both Terra and Aqua satellites.",
    "inLanguage" : "en-US",
    "author" : "img/avatar.jpgPh.D. student in Geoinformation ScienceZhiqi Yu",
    "creator" : "img/avatar.jpgPh.D. student in Geoinformation ScienceZhiqi Yu",
    "publisher": "img/avatar.jpgPh.D. student in Geoinformation ScienceZhiqi Yu",
    "accountablePerson" : "img/avatar.jpgPh.D. student in Geoinformation ScienceZhiqi Yu",
    "copyrightHolder" : "img/avatar.jpgPh.D. student in Geoinformation ScienceZhiqi Yu",
    "copyrightYear" : "2020",
    "datePublished": "2020-02-04 15:21:38 -0500 EST",
    "dateModified" : "2020-02-04 15:21:38 -0500 EST",
    "url" : "https://zhiqiyu.github.io/post/combine-modis-terra-and-aqua-product-on-gee/",
    "wordCount" : "422",
    "keywords" : [ "GEE","Remote Sensing","Blog" ]
}
</script>
</header>
		<div class="wrapper flex">
			<section class="primary">
			
<main class="main" role="main">
	<article class="post">
		
		<header class="post__header">
			<h1 class="post__title">Combine MODIS Terra and Aqua Product on GEE</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 16 16"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
	<time class="meta__text" datetime="2020-02-04T15:21:38">February 04, 2020</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="https://zhiqiyu.github.io/categories/technical" rel="category">Technical</a></span>
</div>
</div>
		
		</header><div class="content post__content clearfix">
			<p>The Moderate Resolution Imaging Spectroradiometer (MODIS) has been providing high temporal resolution images since the first launch of Terra satellite in 1999 followed by the Aqua satellite in 2002. The Terra satellite passes from north to south in the morning at around 10:30 a.m. local time. The Aqua satellite passes from south to north in the afternoon at around 1:30 p.m. Since MODIS has a revisiting time of one or two days, for any given day, there are most likely be images from both Terra and Aqua satellites. Therefore, fusing images from two products together can be useful to mitigate missing value problem due to cloud contaminations because the chance of having cloud at <strong>both</strong> 10:30 a.m. and 1:30 p.m. is definitely lower than having cloud at <strong>either</strong> time.</p>

<p>Specifically, for any given pair of images, the combined value is the mean of the two if both have valid values. If any one is missing, then the other one is taken. If both are missing, it remains missing.</p>

<p>On Google Earth Engine (GEE), this can be easily done by doing a math trick:</p>

<pre><code class="language-javascript">/**
 * This function combines MODIS Terra and Aqua data to generate one dataset. 
 * Originally written for mitigating missing value problem.
 * 
 * @param {ee.Image} terra - multi-band Terra image, number of bands can be 1 to n.
 * @param {ee.Image} aqua - multi-band Aqua image, number of bands should match terra bands.
 */
function combineModis(terra, aqua) {
    var bandwise_and = terra.and(aqua);

    /**
     * if band-wise-and returns 1, then two bands all have values, take the mean,
     * if not, then at least one band has missing value, add them up as the final value
     */
    var multiplicative = bandwise_and.add(1).pow(-1);   // from [0, 1] -&gt; [1, 2] -&gt; [1, 1/2] 
    var combined = terra.add(aqua).multiply(multiplicative);
    return combined;
}
</code></pre>

<p>The trick is by doing bandwise logical and on each pair of bands. The results will be 0 if any band has missing value, and 1 if both have valid values. Then a multiplicative term is calculated by adding 1 to the logical and result and raise to the power of -1. This makes 0 to 1, 1 to 0.5. The mulplicative term is then multiplied by the sum of the band pair. So if any band has missing value, the result will be <code>1 * (Terra + Aqua)</code> for bands with missing values, and <code>0.5 * (Terra + Aqua)</code> for bands with no missing values. There, mission accomplished.</p>

<p>Other useful functions for GEE can be found at the <a href="https://github.com/zhiqiyu/Useful-Scripts-for-Google-Earth-Engine">my repo</a>.</p>

		</div>
		
<div class="post__tags tags clearfix">
	<svg class="icon icon-tag" width="16" height="16" viewBox="0 0 16 16"><path d="M16 9.5c0 .373-.24.74-.5 1l-5 5c-.275.26-.634.5-1 .5-.373 0-.74-.24-1-.5L1 8a2.853 2.853 0 0 1-.7-1C.113 6.55 0 5.973 0 5.6V1.4C0 1.034.134.669.401.401.67.134 1.034 0 1.4 0h4.2c.373 0 .95.113 1.4.3.45.187.732.432 1 .7l7.5 7.502c.26.274.5.632.5.998zM3.5 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="https://zhiqiyu.github.io/tags/gee/" rel="tag">GEE</a></li>
		<li class="tags__item"><a class="tags__link btn" href="https://zhiqiyu.github.io/tags/remote-sensing/" rel="tag">Remote Sensing</a></li>
	</ul>
</div>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="Zhiqi Yu avatar" src="https://zhiqiyu.github.io/img/avatar.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About Zhiqi Yu</span>
	</div>
	<div class="authorbox__description">
		Ph.D. student in Geoinformation Science
	</div>
</div>

<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="https://zhiqiyu.github.io/post/install-and-troubleshoot-docker-toolbox-on-windows-10-home/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">Install and Troubleshoot Docker Toolbox on Windows 10 Home</p></a>
	</div>
</nav>

<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "realm-z" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</section>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2020 Zhiqi Yu.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="https://zhiqiyu.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>